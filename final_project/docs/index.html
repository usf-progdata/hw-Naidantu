<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Bayesian Multidimensional Generalized Graded Unfolding Model (MGGUM) Estimation • bmggum</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Bayesian Multidimensional Generalized Graded Unfolding Model (MGGUM) Estimation">
<meta property="og:description" content="Full Bayesian estimation of Multidimensional Generalized Graded Unfolding Model (MGGUM) using rstan. 
    Functions are provided for estimation, result extraction, model fit statistics, and plottings.">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">bmggum</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="articles/my-vignette.html">bmggum: Bayesian Estimation of Multidimensional Generalized Graded Unfolding Model</a>
    </li>
  </ul>
</li>
<li>
  <a href="news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/Naidantu/bmggum/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">
<div id="bmggum" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#bmggum" class="anchor"></a>bmggum</h1></div>
<!-- badges: start -->
<!-- badges: end -->
<p>The goal of bmggum is to estimate Multidimensional Generalized Graded Unfolding Model (MGGUM) using Bayesian method. Specifically,the R package <strong>rstan</strong> that utilizes the Hamiltonian Monte Carlo sampling algorithm was used for estimation. Below are some important features of the bmggum package:</p>
<ol>
<li>Allows users to incorporate person covariates (e.g., age, gender, education) into the estimation to improve estimation accuracy.</li>
<li>Automatically deals with missing data in a way similar to how full information maximum likelihood handles missing data.</li>
<li>Allows users to estimate the <strong>multidimensional version</strong> of three unfolding models that are available in the software GGUM2004 (Roberts, Fang, Cui, &amp; Wang, 2006).
<ul>
<li>UM8: The Generalized Graded Unfolding Model (GGUM).</li>
<li>UM4: The Partial Credit Unfolding Model, which is the GGUM with all alphas constrained to 1.</li>
<li>UM7: The Generalized Rating Scale Unfolding Model, which is the GGUM with equal taus across items.</li>
</ul>
</li>
<li>Five functions (i.e., bmggum( ), extract.bmggum( ), modfit.bmggum( ), bayesplot.bmggum( ), and itemplot.bmggum( )) are provided for model estimation, results extraction, model fit examination (e.g.,waic, loo, chisq/df), and plottings, respectively.</li>
</ol>
<div id="installation" class="section level2">
<h2 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h2>
<p>You can install the development version of bmggum from GitHub:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://devtools.r-lib.org//reference/remote-reexports.html">install_github</a></span><span class="op">(</span><span class="st">"Naidantu/bmggum"</span><span class="op">)</span></code></pre></div>
</div>
<div id="example" class="section level2">
<h2 class="hasAnchor">
<a href="#example" class="anchor"></a>Example</h2>
<p>This is a basic example that shows you how to prepare data, fit the model, extract and plot results.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/Naidantu/bmggum">bmggum</a></span><span class="op">)</span>

<span class="co">## basic example code</span>
<span class="co">## Step 1: Input data</span>
<span class="co"># 1.1 Response data in wide format</span>
<span class="va">GGUM.Data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">4</span>,<span class="fl">4</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">4</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">3</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="cn">NA</span>,<span class="fl">2</span>,<span class="cn">NA</span>,<span class="fl">3</span>,<span class="fl">2</span>,<span class="fl">2</span>,<span class="fl">2</span>,<span class="fl">1</span>,<span class="fl">3</span>,<span class="fl">2</span>,<span class="cn">NA</span>,<span class="fl">2</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">1</span>,<span class="cn">NA</span>,<span class="cn">NA</span>,<span class="cn">NA</span>,<span class="fl">1</span>,<span class="fl">3</span>,<span class="cn">NA</span>,<span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>
<span class="va">GGUM.Data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="va">GGUM.Data</span>,nrow <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>

<span class="co"># 1.2 A two-row data matrix: the first row is the item number (1,2,3,4...); the second row indicates the signs of delta for each item (-1,0,1,...). For items that have negative deltas for sure, "-1" should be assigned; for items that have positive deltas, "1" should be assigned; for items whose deltas may be either positive or negative (e.g., intermediate items), "0" should assigned. We recommend at least two positive and two negative items per trait for better estimation.</span>
<span class="va">delindex</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="op">-</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">1</span>,<span class="fl">3</span>,<span class="op">-</span><span class="fl">1</span>,<span class="fl">4</span>,<span class="fl">1</span><span class="op">)</span>
<span class="va">delindex</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="va">delindex</span>,nrow <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>

<span class="co"># 1.3 A row vector mapping each item to each trait. For example, c(1,1,1,2,2,2) means that the first 3 items belong to trait 1 and the last 3 items belong to trait 2.</span>
<span class="va">ind</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span>
<span class="va">ind</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="va">ind</span><span class="op">)</span>

<span class="co"># 1.4 An p*c person covariate matrix where p equals sample size and c equals the number of covariates. The default is NULL, meaning no person covariate.</span>
<span class="va">covariate</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.70</span>, <span class="op">-</span><span class="fl">1.25</span>, <span class="fl">0.48</span>, <span class="op">-</span><span class="fl">0.47</span>, <span class="fl">0.86</span>, <span class="fl">1.25</span>, <span class="fl">1.17</span>, <span class="op">-</span><span class="fl">1.35</span>, <span class="op">-</span><span class="fl">0.84</span>, <span class="op">-</span><span class="fl">0.55</span><span class="op">)</span>

<span class="co">## Step 2: Fit the MGGUM model</span>
<span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/bmggum.html">bmggum</a></span><span class="op">(</span>GGUM.Data<span class="op">=</span><span class="va">GGUM.Data</span>, delindex<span class="op">=</span><span class="va">delindex</span>, trait<span class="op">=</span><span class="fl">2</span>, ind<span class="op">=</span><span class="va">ind</span>, option<span class="op">=</span><span class="fl">4</span>, model<span class="op">=</span><span class="st">"UM8"</span>, covariate<span class="op">=</span><span class="va">covariate</span><span class="op">)</span>
<span class="co">#&gt; [1] "Case 9 was deleted because they endorse the same response option across all items"</span>

<span class="co">## Step 3: Extract the estimated results </span>
<span class="co"># 3.1 Extract the theta estimates </span>
<span class="va">theta</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/extract.bmggum.html">extract.bmggum</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">mod</span>, pars<span class="op">=</span><span class="st">'theta'</span><span class="op">)</span>
<span class="co"># Turn the theta estimates into p*trait matrix where p equals sample size and trait equals the number of latent traits</span>
<span class="va">theta</span> <span class="op">&lt;-</span> <span class="va">theta</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>
<span class="co"># nrow=trait</span>
<span class="va">theta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="va">theta</span>, nrow<span class="op">=</span><span class="fl">2</span><span class="op">)</span>  
<span class="va">theta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="va">theta</span><span class="op">)</span>
<span class="co"># theta estimates in p*trait matrix format</span>
<span class="va">theta</span>
<span class="co">#&gt;              [,1]        [,2]</span>
<span class="co">#&gt;  [1,]  1.01172010  0.03007375</span>
<span class="co">#&gt;  [2,] -1.49457843 -0.28825368</span>
<span class="co">#&gt;  [3,] -1.24305523 -0.56841647</span>
<span class="co">#&gt;  [4,]  0.70989404  1.00436767</span>
<span class="co">#&gt;  [5,] -0.05374441 -0.81460972</span>
<span class="co">#&gt;  [6,]  0.10233920 -0.82928930</span>
<span class="co">#&gt;  [7,]  0.80263701  0.21347193</span>
<span class="co">#&gt;  [8,]  0.11552137  0.54509935</span>
<span class="co">#&gt;  [9,]  0.67097662  0.89182374</span>

<span class="co"># 3.2 Extract the tau estimates </span>
<span class="va">tau</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/extract.bmggum.html">extract.bmggum</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">mod</span>, pars<span class="op">=</span><span class="st">'tau'</span><span class="op">)</span>
<span class="co"># Turn the tau estimates into I*(option-1) matrix where I equals the number of items and option equals the number of response options</span>
<span class="va">tau</span> <span class="op">&lt;-</span> <span class="va">tau</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>
<span class="co"># nrow=option-1</span>
<span class="va">tau</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="va">tau</span>, nrow<span class="op">=</span><span class="fl">3</span><span class="op">)</span>  
<span class="va">tau</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="va">tau</span><span class="op">)</span>
<span class="co"># tau estimates in I*(option-1) matrix format</span>
<span class="va">tau</span>
<span class="co">#&gt;            [,1]       [,2]       [,3]</span>
<span class="co">#&gt; [1,] -0.8444732 -1.5242984 -2.2944532</span>
<span class="co">#&gt; [2,] -1.5878937 -1.8973009 -1.1197230</span>
<span class="co">#&gt; [3,] -3.2735301 -0.9010291 -0.8618411</span>
<span class="co">#&gt; [4,] -2.3371485 -1.3746858 -1.0575782</span>

<span class="co"># 3.3 Extract the lambda estimates </span>
<span class="va">lambda</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/extract.bmggum.html">extract.bmggum</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">mod</span>, pars<span class="op">=</span><span class="st">'lambda'</span><span class="op">)</span>
<span class="co"># lambda[1,1] is the coefficient linking person covariate 1 to latent trait 1</span>
<span class="co"># lambda[1,2] is the coefficient linking person covariate 1 to latent trait 2</span>
<span class="va">lambda</span>
<span class="co">#&gt;                   mean    se_mean        sd       2.5%        50%     97.5%</span>
<span class="co">#&gt; lambda[1,1]  0.2300054 0.02218539 0.4684616 -0.6407667  0.2297074 1.2042006</span>
<span class="co">#&gt; lambda[1,2] -0.3465347 0.04595152 0.6728208 -1.8855763 -0.2677931 0.8448643</span>
<span class="co">#&gt;                n_eff     Rhat</span>
<span class="co">#&gt; lambda[1,1] 445.8758 1.000741</span>
<span class="co">#&gt; lambda[1,2] 214.3873 1.003417</span>

<span class="co">## Step 4: Obtain model fit statistics </span>
<span class="va">waic</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/modfit.bmggum.html">modfit.bmggum</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">mod</span>, index<span class="op">=</span><span class="st">'waic'</span><span class="op">)</span>
<span class="va">loo</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/modfit.bmggum.html">modfit.bmggum</a></span><span class="op">(</span><span class="va">mod</span><span class="op">)</span>

<span class="co">## Step 5: Plottings</span>
<span class="co"># 5.1 Obtain the density plots for alpha</span>
<span class="fu"><a href="reference/bayesplot.bmggum.html">bayesplot.bmggum</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">mod</span>, pars<span class="op">=</span><span class="st">'alpha'</span>, plot<span class="op">=</span><span class="st">'density'</span>, inc_warmup<span class="op">=</span><span class="cn">F</span><span class="op">)</span></code></pre></div>
<p><img src="reference/figures/README-example-1.png" width="70%"></p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Step 6: Plotting observable response categories (ORCs) for items</span>
<span class="co"># 6.1 Obtain item plots with ORCs for item 1, 2, 3</span>
<span class="fu"><a href="reference/itemplot.bmggum.html">itemplot.bmggum</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">mod</span>, items <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span></code></pre></div>
<p><img src="reference/figures/README-example-2.png" width="70%"></p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="links">
<h2>Links</h2>
<ul class="list-unstyled">
<li>Browse source code at <br><a href="https://github.com/Naidantu/bmggum/">https://​github.com/​Naidantu/​bmggum/​</a>
</li>
<li>Report a bug at <br><a href="https://github.com/Naidantu/bmggum/issues">https://​github.com/​Naidantu/​bmggum/​issues</a>
</li>
</ul>
</div>
<div class="license">
<h2>License</h2>
<ul class="list-unstyled">
<li>GPL (&gt;= 3)</li>
</ul>
</div>
<div class="developers">
<h2>Developers</h2>
<ul class="list-unstyled">
<li>Naidan Tu <br><small class="roles"> Author, maintainer </small>  </li>
<li>Bo Zhang <br><small class="roles"> Author </small>  </li>
</ul>
</div>

  </div>
</div>


      <footer><div class="copyright">
  <p>Developed by Naidan Tu, Bo Zhang.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
